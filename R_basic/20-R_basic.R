## ----r_setup, include=FALSE--------------------------
knitr::opts_chunk$set(echo = TRUE, message = FALSE)


## ----eval=FALSE--------------------------------------
## options(repos="http://mirrors.tuna.tsinghua.edu.cn/CRAN/")
## install.packages("dplyr")


## ----eval=FALSE--------------------------------------
## options(BioC_mirror="http://mirrors.tuna.tsinghua.edu.cn/bioconductor/")
## BiocManager::install("DESeq2")


## ----------------------------------------------------
getwd()


## ----eval=FALSE--------------------------------------
## setwd("/home/zhxd/My_Course/BioR")


## ----------------------------------------------------
gene1_s1 <- 10
gene1_s2 <- 20
gene1_s3 <- 30
gene1_s4 <- 40


## ----------------------------------------------------
gene1_total <- gene1_s1 + gene1_s2 + gene1_s3 + gene1_s4
gene1_total


## ----------------------------------------------------
gene1 <- c(10, 20, 30, 40)
gene1


## ----------------------------------------------------
gene1_total <- 0
for (i in gene1){
  gene1_total = gene1_total + i
}
gene1_total


## ----------------------------------------------------
gene1_total <- sum(gene1)
gene1_total


## ----------------------------------------------------
gene_exp <- read.delim("data/R_basic/genes.TMM.EXPR.matrix", row.names=1)


## ----------------------------------------------------
head(apply(gene_exp, 1, sum))


## ----------------------------------------------------
head(apply(gene_exp, 2, sum))


## ----------------------------------------------------
sample_cor <- cor(gene_exp)
sample_cor[1:4,1:4]


## ----eval=FALSE--------------------------------------
## # 安装 pheatmap 包
## install.packages("pheatmap")


## ----------------------------------------------------
# 加载 pheatmap 包
library(pheatmap, quietly = T)

# 调用 pheatmap 包里的 pheatmap() 函数画图
pheatmap(sample_cor,
         cluster_rows = F,
         cluster_cols = F)


## a = 1

## b = [1]

## a == b


## ----------------------------------------------------
a <- 1
b <- c(1)
a == b


## ----------------------------------------------------
v <- c(1, 2, 3, 4, 5)
v


## ----------------------------------------------------
class(v)


## ----------------------------------------------------
1:5


## ----------------------------------------------------
rep(3,10)


## ----------------------------------------------------
v[1]


## ----------------------------------------------------
v[1:3]


## ----------------------------------------------------
v[c(1,3,5)]


## ----------------------------------------------------
v[-c(2,4)]


## ----------------------------------------------------
v[v%%2 == 0]


## ----------------------------------------------------
names(v) <- c('chr1', 'chr2', 'chr3', 'chr4', 'chr5')
v


## ----------------------------------------------------
v['chr3']


## ----------------------------------------------------
v + 1


## ----------------------------------------------------
v + c(1,2)


## ----------------------------------------------------
df <- data.frame(S1 = c(1, 2, 3, 4, 5), 
                 S2 = c(5, 4, 3, 2, 1), 
                 S3 = runif(5, -10, 10), # -10 到 10 之间，生成 5 个数
                 S4 = runif(5, -10, 10))
df


## ----------------------------------------------------
colnames(df)


## ----------------------------------------------------
rownames(df)


## ----------------------------------------------------
rownames(df) <- c("gene1", "gene2", "gene3", "gene4", "gene5")
df


## ----------------------------------------------------
ncol(df)


## ----------------------------------------------------
nrow(df)


## ----------------------------------------------------
dim(df)


## ----------------------------------------------------
head(df, n = 2)


## ----------------------------------------------------
tail(df, n = 2)


## ----------------------------------------------------
df$S1


## ----------------------------------------------------
df[1:3,1:3]


## ----------------------------------------------------
df[c('gene1', 'gene3'),c('S1', 'S2' )]


## ----------------------------------------------------
df[,1:3]


## ----------------------------------------------------
subset(df, S1>1, select = c("S2", "S4"))


## ----------------------------------------------------
df[2,2]


## ----------------------------------------------------
head(df + c(1,2))


## ----------------------------------------------------
rowSums(df)


## ----------------------------------------------------
colSums(df)


## ----------------------------------------------------
colMeans(df)


## ----------------------------------------------------
rowMeans(df)


## ----------------------------------------------------
apply(df, 1, mean)


## ----------------------------------------------------
apply(df, 2, mean)


## ----------------------------------------------------
a <- c(1, -3, 5.64)
b <- c(1, 4, 2.3)


## ----------------------------------------------------
class(a)


## ----------------------------------------------------
round(a, digits = 1)


## ----------------------------------------------------
abs(a)


## ----------------------------------------------------
sqrt(b)


## ----------------------------------------------------
sum(a)


## ----------------------------------------------------
sd(a)


## ----------------------------------------------------
a * b


## ----------------------------------------------------
a ** b
# a^b


## ----------------------------------------------------
a / b


## ----------------------------------------------------
a %% b


## ----------------------------------------------------
a %/% b


## ----------------------------------------------------
cor(a, b)


## ----------------------------------------------------
s <- c('A', 'TT', 'CCC', 'GGGG')
s


## ----------------------------------------------------
class(s)


## ----------------------------------------------------
library(stringr, quietly = T)


## ----------------------------------------------------
str_count(s, 'T')


## ----------------------------------------------------
str_sub(s, 1, 3)


## ----------------------------------------------------
str_subset(s, 'C')


## ----------------------------------------------------
str_length(s)


## ----------------------------------------------------
str_replace(s, 'G', 'N')


## ----------------------------------------------------
str_replace_all(s, 'G', 'N')


## ----------------------------------------------------
str_to_lower(s)


## ----------------------------------------------------
str_c(c('chr1', 'chr2', 'chr3', 'chr4'), s, sep = ':')


## ----------------------------------------------------
str_split(s, '', simplify = T)


## ----------------------------------------------------
str_sort(s)


## ----------------------------------------------------
x <- c(T, F, T)
y <- c(F, F, F)
class(x)


## ----------------------------------------------------
x | y


## ----------------------------------------------------
x || y


## ----------------------------------------------------
x & y


## ----------------------------------------------------
x && y


## ----------------------------------------------------
!x


## ----------------------------------------------------
all(x)


## ----------------------------------------------------
any(x)


## ----------------------------------------------------
gene_exp <- read.table("data/R_basic/genes.TMM.EXPR.matrix", 
                       header = T,
                       row.names=1)
gene_exp[1:3,1:3]


## ----------------------------------------------------
write.table(gene_exp, 
            file = "output/gene_exp.txt",
            sep = "\t",
            quote = F)


## ----------------------------------------------------
a <- 1
b <- 2
save(a, b, file = 'output/mydata.rdata')
rm(a, b)


## ----------------------------------------------------
load('output/mydata.rdata')


## ----------------------------------------------------
pdf(file = 'output/myplot.pdf')
plot(x = runif(n = 10, 1, 100), y = runif(n = 10, 1, 100))
dev.off()

